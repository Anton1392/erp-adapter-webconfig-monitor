namespace Tests;
using System.Text.Json;

[TestClass]
public class UnitTest1
{
    [TestMethod]
    public void TestMethod1()
    { 
      
      var M240_All_Parts = """[{"Id":"544516405874970197","PartNumber":"E-108"},{"Id":"544516405874970205","PartNumber":"E-109"},{"Id":"544516405874970213","PartNumber":"E-106"},{"Id":"544516405874970221","PartNumber":"E-107"},{"Id":"544516405874970229","PartNumber":"E-104"},{"Id":"544516405874970237","PartNumber":"E-105"},{"Id":"544516405874970245","PartNumber":"E-102"},{"Id":"544516405874970253","PartNumber":"E-103"},{"Id":"544516405874970269","PartNumber":"E-101"},{"Id":"544516405874970287","PartNumber":"E-100"},{"Id":"544516406948711442","PartNumber":"G-105"},{"Id":"544516406948711467","PartNumber":"G-104"},{"Id":"544516406948711477","PartNumber":"G-102"},{"Id":"544516406948711484","PartNumber":"G-103"},{"Id":"544516406948711495","PartNumber":"G-100"},{"Id":"544516406948711502","PartNumber":"G-101"},{"Id":"544516406948711505","PartNumber":"F-900"},{"Id":"544516406948711512","PartNumber":"F-905M"},{"Id":"544516406948711522","PartNumber":"F-128"},{"Id":"544516406948711530","PartNumber":"F-60"},{"Id":"544516406948711538","PartNumber":"F-126"},{"Id":"544516406948711546","PartNumber":"F-127"},{"Id":"544516406948711555","PartNumber":"F-124"},{"Id":"544516406948711562","PartNumber":"F-125"},{"Id":"544516406948711572","PartNumber":"F-123"},{"Id":"544516406948711590","PartNumber":"F-121"},{"Id":"544516406948711597","PartNumber":"F-122"},{"Id":"544516406948711600","PartNumber":"F-119"},{"Id":"544516406948711615","PartNumber":"F-120"},{"Id":"544516406948711617","PartNumber":"F-117"},{"Id":"544516406948711624","PartNumber":"F-118"},{"Id":"544516406948711635","PartNumber":"F-115"},{"Id":"544516406948711642","PartNumber":"F-116"},{"Id":"544516406948711652","PartNumber":"F-114"},{"Id":"544516406948711670","PartNumber":"F-112"},{"Id":"544516406948711677","PartNumber":"F-113"},{"Id":"544516406948711941","PartNumber":"E-118"},{"Id":"544516406948711949","PartNumber":"E-119"},{"Id":"544516406948711957","PartNumber":"E-116"},{"Id":"544516406948711965","PartNumber":"E-117"},{"Id":"544516406948711973","PartNumber":"E-114"},{"Id":"544516406948711981","PartNumber":"E-115"},{"Id":"544516406948711989","PartNumber":"E-112"},{"Id":"544516406948711997","PartNumber":"E-113"},{"Id":"544516406948712005","PartNumber":"E-110"},{"Id":"544516406948712013","PartNumber":"E-111"},{"Id":"544516406948712193","PartNumber":"F-109"},{"Id":"544516406948712207","PartNumber":"F-111"},{"Id":"544516406948712219","PartNumber":"F-108"},{"Id":"544516406948712230","PartNumber":"F-107"},{"Id":"544516406948712236","PartNumber":"F-110"},{"Id":"544516406948712242","PartNumber":"F-105"},{"Id":"544516406948712248","PartNumber":"F-106"},{"Id":"544516406948712260","PartNumber":"F-104"},{"Id":"544516406948712272","PartNumber":"F-102"},{"Id":"544516406948712286","PartNumber":"F-103"},{"Id":"544516406948712298","PartNumber":"F-101"},{"Id":"544516406948712308","PartNumber":"E-135"},{"Id":"544516406948712316","PartNumber":"F-100"},{"Id":"544516406948712324","PartNumber":"E-133"},{"Id":"544516406948712332","PartNumber":"E-134"},{"Id":"544516406948712340","PartNumber":"E-131"},{"Id":"544516406948712348","PartNumber":"E-132"},{"Id":"544516406948712356","PartNumber":"E-129O"},{"Id":"544516406948712364","PartNumber":"E-130"},{"Id":"544516406948712372","PartNumber":"E-128"},{"Id":"544516406948712380","PartNumber":"E-129I"},{"Id":"544516406948712388","PartNumber":"E-126"},{"Id":"544516406948712396","PartNumber":"E-127"},{"Id":"544516406948712405","PartNumber":"E-124"},{"Id":"544516406948712412","PartNumber":"E-125"},{"Id":"544516406948712421","PartNumber":"E-122"},{"Id":"544516406948712429","PartNumber":"E-123"},{"Id":"544516406948712437","PartNumber":"E-120"},{"Id":"544516406948712445","PartNumber":"E-121"},{"Id":"544516408022450915","PartNumber":"P-100"},{"Id":"544516408022450921","PartNumber":"P-101"},{"Id":"544516408022450932","PartNumber":"O-69"},{"Id":"544516408022453248","PartNumber":"G-107"},{"Id":"544516408022453263","PartNumber":"G-108"},{"Id":"544516408022453273","PartNumber":"G-106"},{"Id":"544516408022453508","PartNumber":"O-67"},{"Id":"544516408022453516","PartNumber":"O-68"},{"Id":"544516408022453526","PartNumber":"O-65"},{"Id":"544516408022453533","PartNumber":"O-66"},{"Id":"544516408022453536","PartNumber":"O-63"},{"Id":"544516408022453551","PartNumber":"O-64"},{"Id":"544516408022453554","PartNumber":"O-61"},{"Id":"544516408022453561","PartNumber":"O-62"},{"Id":"544516408022453571","PartNumber":"O-30"},{"Id":"544516408022453579","PartNumber":"O-60"},{"Id":"544516408022453587","PartNumber":"O-10"},{"Id":"544516408022453595","PartNumber":"O-11"},{"Id":"544516408022453603","PartNumber":"M-107"},{"Id":"544516408022453611","PartNumber":"M-901"},{"Id":"544516408022453627","PartNumber":"M-106"},{"Id":"544516408022453637","PartNumber":"M-104"},{"Id":"544516408022453644","PartNumber":"M-105"},{"Id":"544516408022453653","PartNumber":"M-102"},{"Id":"544516408022453661","PartNumber":"M-103"},{"Id":"544516408022453671","PartNumber":"M-100"},{"Id":"544516408022453678","PartNumber":"M-101"},{"Id":"544516408022453681","PartNumber":"G-901"},{"Id":"544516408022453688","PartNumber":"G-902"},{"Id":"544516408022453699","PartNumber":"G-114"},{"Id":"544516408022453706","PartNumber":"G-60"},{"Id":"544516408022453716","PartNumber":"G-113"},{"Id":"544516408022453733","PartNumber":"G-111"},{"Id":"544516408022453741","PartNumber":"G-112"},{"Id":"544516408022453750","PartNumber":"G-109"},{"Id":"544516408022453757","PartNumber":"G-110"},{"Id":"544650950020538624","PartNumber":"F-202"},{"Id":"544650950020538632","PartNumber":"F-203"},{"Id":"544650950020538640","PartNumber":"F-201"},{"Id":"544650950020538648","PartNumber":"F-2010"},{"Id":"544650950020538656","PartNumber":"F-2008"},{"Id":"544650950020538664","PartNumber":"F-2009"},{"Id":"544650950020538672","PartNumber":"F-2006"},{"Id":"544650950020538680","PartNumber":"F-2007"},{"Id":"544650950020538688","PartNumber":"F-2004"},{"Id":"544650950020538696","PartNumber":"F-2005"},{"Id":"544650950020538704","PartNumber":"F-2002"},{"Id":"544650950020538712","PartNumber":"F-2003"},{"Id":"544650950020538720","PartNumber":"F-2000"},{"Id":"544650950020538728","PartNumber":"F-2001"},{"Id":"544650950020538736","PartNumber":"E-2002"},{"Id":"544650950020538744","PartNumber":"F-200"},{"Id":"544650950020538754","PartNumber":"E-2000"},{"Id":"544650950020539909","PartNumber":"M-2002D"},{"Id":"544650950020539917","PartNumber":"M-2002F"},{"Id":"544650950020539925","PartNumber":"M-2001D"},{"Id":"544650950020539933","PartNumber":"M-2001F"},{"Id":"544650950020539941","PartNumber":"M-200"},{"Id":"544650950020539949","PartNumber":"M-2000F"},{"Id":"544650950020539959","PartNumber":"G-2002"},{"Id":"544650950020539966","PartNumber":"G-2003"},{"Id":"544650950020539975","PartNumber":"G-2000"},{"Id":"544650950020539983","PartNumber":"G-2001"},{"Id":"544650950020539992","PartNumber":"G-200"},{"Id":"544650950020540000","PartNumber":"F-222"},{"Id":"544650950020540008","PartNumber":"F-223"},{"Id":"544650950020540016","PartNumber":"F-220"},{"Id":"544650950020540024","PartNumber":"F-221"},{"Id":"544650950020540032","PartNumber":"F-218"},{"Id":"544650950020540040","PartNumber":"F-219"},{"Id":"544650950020540048","PartNumber":"F-216"},{"Id":"544650950020540056","PartNumber":"F-217"},{"Id":"544650950020540064","PartNumber":"F-214"},{"Id":"544650950020540072","PartNumber":"F-215"},{"Id":"544650950020540080","PartNumber":"F-212"},{"Id":"544650950020540088","PartNumber":"F-213"},{"Id":"544650950020540096","PartNumber":"F-210"},{"Id":"544650950020540104","PartNumber":"F-211"},{"Id":"544650950020540112","PartNumber":"F-208"},{"Id":"544650950020540120","PartNumber":"F-209"},{"Id":"544650950020540128","PartNumber":"F-206"},{"Id":"544650950020540136","PartNumber":"F-207"},{"Id":"544650950020540144","PartNumber":"F-204"},{"Id":"544650950020540379","PartNumber":"M-205"},{"Id":"544650950020540405","PartNumber":"M-201"},{"Id":"544650950020540413","PartNumber":"M-202"},{"Id":"544650951094282099","PartNumber":"P-202"},{"Id":"544650951094282107","PartNumber":"P-203"},{"Id":"544650951094282115","PartNumber":"P-2004"},{"Id":"544650951094282123","PartNumber":"P-201"},{"Id":"544650951094282131","PartNumber":"P-2002"},{"Id":"544650951094282139","PartNumber":"P-2003"},{"Id":"544650951094282147","PartNumber":"P-2000"},{"Id":"544650951094282155","PartNumber":"P-2001"},{"Id":"544650951094282163","PartNumber":"P-204"},{"Id":"544650951094282171","PartNumber":"P-200"},{"Id":"544650951094282179","PartNumber":"M-206"},{"Id":"544650951094282187","PartNumber":"M-207"},{"Id":"544961391330519292","PartNumber":"F-BCXX"},{"Id":"544962117179993670","PartNumber":"PIC"},{"Id":"544962117179993686","PartNumber":"O-900"},{"Id":"544962117179993694","PartNumber":"9999"},{"Id":"544962117179993702","PartNumber":"F-2007_2"},{"Id":"544962117179993712","PartNumber":"F-2007_1"},{"Id":"546123038249964517","PartNumber":"G-000"},{"Id":"546353042338142288","PartNumber":"C-127"},{"Id":"546353042338142296","PartNumber":"C-221"},{"Id":"546353042338142304","PartNumber":"C-125"},{"Id":"546353042338142312","PartNumber":"C-126"},{"Id":"546353042338142320","PartNumber":"C-123"},{"Id":"546353042338142328","PartNumber":"C-124"},{"Id":"546353042338142336","PartNumber":"C-121"},{"Id":"546353042338142344","PartNumber":"C-122"},{"Id":"546353042338142352","PartNumber":"C-119"},{"Id":"546353042338142360","PartNumber":"C-120"},{"Id":"546353042338142368","PartNumber":"C-117"},{"Id":"546353042338142376","PartNumber":"C-118"},{"Id":"546353042338142384","PartNumber":"C-115"},{"Id":"546353042338142392","PartNumber":"C-116"},{"Id":"546353042338142400","PartNumber":"C-113"},{"Id":"546353042338142408","PartNumber":"C-114"},{"Id":"546353042338142416","PartNumber":"C-111"},{"Id":"546353042338142424","PartNumber":"C-112"},{"Id":"546353042338142432","PartNumber":"C-109"},{"Id":"546353042338142440","PartNumber":"C-110"},{"Id":"546353042338142448","PartNumber":"C-107"},{"Id":"546353042338142456","PartNumber":"C-108"},{"Id":"546353042338142976","PartNumber":"C-105"},{"Id":"546353042338142984","PartNumber":"C-106"},{"Id":"546353042338142992","PartNumber":"C-103"},{"Id":"546353042338143000","PartNumber":"C-104"},{"Id":"546353042338143008","PartNumber":"C-101"},{"Id":"546353042338143016","PartNumber":"C-102"},{"Id":"546353042338143024","PartNumber":"C-BMS456"},{"Id":"546353042338143032","PartNumber":"C-BMS888"},{"Id":"546353042338143040","PartNumber":"C-999"},{"Id":"546353042338143048","PartNumber":"C-BMS123"},{"Id":"546353042338143056","PartNumber":"C-313"},{"Id":"546353042338143064","PartNumber":"C-314"},{"Id":"546353042338143072","PartNumber":"C-311"},{"Id":"546353042338143080","PartNumber":"C-312"},{"Id":"546353042338143088","PartNumber":"C-309"},{"Id":"546353042338143096","PartNumber":"C-310"},{"Id":"546353042338143104","PartNumber":"C-307"},{"Id":"546353042338143112","PartNumber":"C-308"},{"Id":"546353042338143120","PartNumber":"C-305"},{"Id":"546353042338143128","PartNumber":"C-306"},{"Id":"546353042338143136","PartNumber":"C-303"},{"Id":"546353042338143144","PartNumber":"C-304"},{"Id":"546353042338143160","PartNumber":"C-302"},{"Id":"546353042338143178","PartNumber":"C-301"},{"Id":"546353043411884032","PartNumber":"C-230"},{"Id":"546353043411884040","PartNumber":"C-231"},{"Id":"546353043411884048","PartNumber":"C-228"},{"Id":"546353043411884056","PartNumber":"C-229"},{"Id":"546353043411884064","PartNumber":"C-226"},{"Id":"546353043411884072","PartNumber":"C-227"},{"Id":"546353043411884080","PartNumber":"C-224"},{"Id":"546353043411884088","PartNumber":"C-225"},{"Id":"546353043411884096","PartNumber":"C-222"},{"Id":"546353043411884104","PartNumber":"C-223"},{"Id":"546353043411884384","PartNumber":"C-TTX46MT"},{"Id":"546353043411884400","PartNumber":"C-248"},{"Id":"546353043411884408","PartNumber":"C-TTX40"},{"Id":"546353043411884416","PartNumber":"C-246"},{"Id":"546353043411884424","PartNumber":"C-247"},{"Id":"546353043411884432","PartNumber":"C-244"},{"Id":"546353043411884440","PartNumber":"C-245"},{"Id":"546353043411884448","PartNumber":"C-242"},{"Id":"546353043411884456","PartNumber":"C-243"},{"Id":"546353043411884464","PartNumber":"C-240"},{"Id":"546353043411884472","PartNumber":"C-241"},{"Id":"546353043411884480","PartNumber":"C-238"},{"Id":"546353043411884488","PartNumber":"C-239"},{"Id":"546353043411884496","PartNumber":"C-236"},{"Id":"546353043411884504","PartNumber":"C-237"},{"Id":"546353043411884512","PartNumber":"C-234"},{"Id":"546353043411884520","PartNumber":"C-235"},{"Id":"546353043411884528","PartNumber":"C-232"},{"Id":"546353043411884536","PartNumber":"C-233"},{"Id":"546355240287654405","PartNumber":"C-250"},{"Id":"546355240287654413","PartNumber":"C-251"},{"Id":"546355240287654421","PartNumber":"CARX"},{"Id":"546355240287654429","PartNumber":"C-249"},{"Id":"546355240287654445","PartNumber":"C-316"},{"Id":"546355240287654463","PartNumber":"C-315"},{"Id":"546357664796653596","PartNumber":"C-252"},{"Id":"546357664796654066","PartNumber":"C-253"},{"Id":"546357664796654074","PartNumber":"C-254"},{"Id":"546411274578509096","PartNumber":"90000001"},{"Id":"546413091349662705","PartNumber":"90000002"},{"Id":"546453173058335680","PartNumber":"M-2000D"},{"Id":"546470239110837413","PartNumber":"F-224"},{"Id":"546736246836642985","PartNumber":"F-2007_3"},{"Id":"546744558671673440","PartNumber":"F-2011"},{"Id":"546744957029891616","PartNumber":"F-205"},{"Id":"546748253417277564","PartNumber":"F-225"},{"Id":"546750232323457058","PartNumber":"F-2012"},{"Id":"546752576301864101","PartNumber":"F-BC80200"},{"Id":"546752676159875743","PartNumber":"F-BC40200"},{"Id":"547566148336246153","PartNumber":"E-394583"},{"Id":"547566300807582603","PartNumber":"E-842032"},{"Id":"547566469385049797","PartNumber":"E-123378"},{"Id":"549761059160132060","PartNumber":"O-70"},{"Id":"549766403173215649","PartNumber":"90000003"},{"Id":"549768086800393583","PartNumber":"P-2005"},{"Id":"549768332687276974","PartNumber":"P-2006"},{"Id":"549768638703696267","PartNumber":"P-2007"},{"Id":"549768867410706298","PartNumber":"P-2008"},{"Id":"549773378200100254","PartNumber":"FAC"},{"Id":"551547157818606046","PartNumber":"FREIGHT"},{"Id":"553839444419150497","PartNumber":"M-2003"},{"Id":"553840901486808655","PartNumber":"M-108"},{"Id":"553845897607573432","PartNumber":"M-208"},{"Id":"553846717946321583","PartNumber":"M-209"},{"Id":"553848089114625687","PartNumber":"M-210"},{"Id":"553849195068696690","PartNumber":"P-102"},{"Id":"553849836092559690","PartNumber":"M-211"},{"Id":"553851137467647433","PartNumber":"M-212"},{"Id":"553852516152151767","PartNumber":"P-205"},{"Id":"553857261017184506","PartNumber":"M-213"},{"Id":"556475702873151724","PartNumber":"P-2009"},{"Id":"573860370943827679","PartNumber":"0000"},{"Id":"577560757995006725","PartNumber":"PRE_INV"},{"Id":"693035818551719532","PartNumber":"M-230"},{"Id":"693037771688132956","PartNumber":"M-130"},{"Id":"693038681147458908","PartNumber":"M-131"},{"Id":"693038931329304538","PartNumber":"M-132"},{"Id":"693039088095611104","PartNumber":"M-133"},{"Id":"693040686897190622","PartNumber":"M-231"},{"Id":"693041497572268552","PartNumber":"M-232"},{"Id":"693041944248868336","PartNumber":"M-233"},{"Id":"693047611458195720","PartNumber":"M-234"},{"Id":"693050488012545272","PartNumber":"M-2300"},{"Id":"707433796463833993","PartNumber":"M-240"},{"Id":"707435321177219946","PartNumber":"M-240-1"},{"Id":"707435482238493977","PartNumber":"M-240-2"},{"Id":"707438266451046323","PartNumber":"M-250"},{"Id":"707441219241050535","PartNumber":"M-250-1"},{"Id":"707441413588321235","PartNumber":"M-250-2"},{"Id":"707441480160314809","PartNumber":"M-250-3"},{"Id":"707441538142373767","PartNumber":"M-250-4"},{"Id":"707441590755723715","PartNumber":"M-250-5"},{"Id":"707441655180233720","PartNumber":"M-250-6"},{"Id":"708612686435094527","PartNumber":"M-260"},{"Id":"708627221678185959","PartNumber":"M-260-1-1"},{"Id":"708627323683657403","PartNumber":"M-260-1-2"},{"Id":"708627460048866274","PartNumber":"M-260-1-3"},{"Id":"708627533063310815","PartNumber":"M-260-1-4"},{"Id":"708627644732456973","PartNumber":"M-260-1-5"},{"Id":"708627709156967142","PartNumber":"M-260-1-6"},{"Id":"708627832637277362","PartNumber":"M-260-2-1"},{"Id":"708627935716493150","PartNumber":"M-260-2-2"},{"Id":"708628101075253738","PartNumber":"M-260-2-3"},{"Id":"708628288980073577","PartNumber":"M-260-3-1"},{"Id":"708628389911805717","PartNumber":"M-260-3-2"},{"Id":"708628463999988164","PartNumber":"M-260-3-3"},{"Id":"708628517687079824","PartNumber":"M-260-3-4"},{"Id":"708628687338288862","PartNumber":"M-260-4-1"},{"Id":"708628760352729437","PartNumber":"M-260-4-2"},{"Id":"708628837662141323","PartNumber":"M-260-4-3"},{"Id":"708628897791684183","PartNumber":"M-260-4-4"},{"Id":"708630152995870691","PartNumber":"M-260-5-1"},{"Id":"708630329089526108","PartNumber":"M-260-5-2"},{"Id":"708630523436796790","PartNumber":"M-260-5-3"},{"Id":"708630900320177450","PartNumber":"M-260-5-4"},{"Id":"759086410471013189","PartNumber":"M-241"},{"Id":"993513117160949618","PartNumber":"M-240-0"}]""";
      var M240_PartConfigurationState = """{"$id":"1","SessionId":"b6ee6341-92ed-483a-85f4-73180bc04c59","ExpiresAt":"2024-01-18T20:55:31.9725877+02:00","CustomerId":"547575408285834014","Comment":null,"PartConfigurationTemplateSnapshotId":"993518285080342797","PartConfigurationTemplateId":"707434354809585488","PartConfigurationTemplateVersion":11,"PartConfigurationId":"1113532685951609556","IsValid":true,"AlternativePreparationCode":"","DiscountPercentage":0,"LockedDiscount":false,"LockedUnitPrice":false,"PartId":"707433796463833993","PriceFormulaFactor":0.01,"Quantity":1,"StandardPrice":{"$id":"2","Amount":0,"CurrencyId":"2"},"UnitPrice":{"$id":"3","Amount":0,"CurrencyId":"2"},"UnitPriceInCompanyCurrency":{"$id":"4","Amount":0,"CurrencyId":"2"},"WeightPerUnit":0,"Sections":[{"$id":"5","Id":"993518285080342789","Description":"Design","Comment":null,"Visible":true,"Sections":[],"Variables":[{"$id":"6","Id":"707434600696463128","Name":"Width","Description":"Width","Comment":null,"Mandatory":true,"HasDefaultValue":false,"Min":100,"Max":2000,"RoundingBase":1,"NumberOfDecimals":0,"UnitId":"541165834165928899","UnitCode":"mm","VariableType":1,"DefaultValue":{"$id":"7","Type":1,"StringValue":null,"BooleanValue":false,"NumericValue":100,"DateTimeValue":"0001-01-01T00:00:00"},"ExtraFieldTemplateId":null,"Formula":null,"BindPropertyType":null,"RowIndex":1,"SelectionComment":{"$id":"8","Id":"0","Text":"","RawText":"","HasFileLinks":false,"FileLinks":null},"SelectionType":0,"ValueSelectionType":0,"Value":{"$id":"9","Type":1,"StringValue":null,"BooleanValue":false,"NumericValue":100,"DateTimeValue":"0001-01-01T00:00:00"},"IsAvailable":true,"ValidationResults":[],"SelectionCommentDocumentOverrides":7,"DocumentDisplaySettings":null},{"$id":"10","Id":"707434668342198034","Name":"Depth","Description":"Depth","Comment":null,"Mandatory":true,"HasDefaultValue":false,"Min":100,"Max":2000,"RoundingBase":1,"NumberOfDecimals":0,"UnitId":"541165834165928899","UnitCode":"mm","VariableType":1,"DefaultValue":{"$id":"11","Type":1,"StringValue":null,"BooleanValue":false,"NumericValue":100,"DateTimeValue":"0001-01-01T00:00:00"},"ExtraFieldTemplateId":null,"Formula":null,"BindPropertyType":null,"RowIndex":2,"SelectionComment":{"$id":"12","Id":"0","Text":"","RawText":"","HasFileLinks":false,"FileLinks":null},"SelectionType":0,"ValueSelectionType":0,"Value":{"$id":"13","Type":1,"StringValue":null,"BooleanValue":false,"NumericValue":100,"DateTimeValue":"0001-01-01T00:00:00"},"IsAvailable":true,"ValidationResults":[],"SelectionCommentDocumentOverrides":7,"DocumentDisplaySettings":null},{"$id":"14","Id":"707434704849420055","Name":"HoleSize","Description":"Hole size","Comment":null,"Mandatory":true,"HasDefaultValue":false,"Min":5,"Max":100,"RoundingBase":1,"NumberOfDecimals":0,"UnitId":"541165834165928899","UnitCode":"mm","VariableType":1,"DefaultValue":{"$id":"15","Type":1,"StringValue":null,"BooleanValue":false,"NumericValue":5,"DateTimeValue":"0001-01-01T00:00:00"},"ExtraFieldTemplateId":null,"Formula":null,"BindPropertyType":null,"RowIndex":4,"SelectionComment":{"$id":"16","Id":"0","Text":"","RawText":"","HasFileLinks":false,"FileLinks":null},"SelectionType":0,"ValueSelectionType":0,"Value":{"$id":"17","Type":1,"StringValue":null,"BooleanValue":false,"NumericValue":5,"DateTimeValue":"0001-01-01T00:00:00"},"IsAvailable":true,"ValidationResults":[],"SelectionCommentDocumentOverrides":7,"DocumentDisplaySettings":null},{"$id":"18","Id":"707434796117475092","Name":"HoleSpacing","Description":"Hole spacing","Comment":null,"Mandatory":true,"HasDefaultValue":false,"Min":1,"Max":50,"RoundingBase":1,"NumberOfDecimals":0,"UnitId":"541165834165928899","UnitCode":"mm","VariableType":1,"DefaultValue":{"$id":"19","Type":1,"StringValue":null,"BooleanValue":false,"NumericValue":1,"DateTimeValue":"0001-01-01T00:00:00"},"ExtraFieldTemplateId":null,"Formula":null,"BindPropertyType":null,"RowIndex":5,"SelectionComment":{"$id":"20","Id":"0","Text":"","RawText":"","HasFileLinks":false,"FileLinks":null},"SelectionType":0,"ValueSelectionType":0,"Value":{"$id":"21","Type":1,"StringValue":null,"BooleanValue":false,"NumericValue":1,"DateTimeValue":"0001-01-01T00:00:00"},"IsAvailable":true,"ValidationResults":[],"SelectionCommentDocumentOverrides":7,"DocumentDisplaySettings":null},{"$id":"22","Id":"707434850878308329","Name":"Area","Description":"Area","Comment":null,"Mandatory":false,"HasDefaultValue":false,"Min":null,"Max":null,"RoundingBase":null,"NumberOfDecimals":1,"UnitId":"541165834165928866","UnitCode":"m²","VariableType":1,"DefaultValue":null,"ExtraFieldTemplateId":null,"Formula":"[707434600696463128]*[707434668342198034]/1000000 ","BindPropertyType":null,"RowIndex":6,"SelectionComment":{"$id":"23","Id":"0","Text":"","RawText":"","HasFileLinks":false,"FileLinks":null},"SelectionType":0,"ValueSelectionType":2,"Value":{"$id":"24","Type":1,"StringValue":null,"BooleanValue":false,"NumericValue":0.01,"DateTimeValue":"0001-01-01T00:00:00"},"IsAvailable":true,"ValidationResults":[],"SelectionCommentDocumentOverrides":7,"DocumentDisplaySettings":null},{"$id":"25","Id":"707434979727327203","Name":"Perforation","Description":"Perforation","Comment":null,"Mandatory":false,"HasDefaultValue":false,"Min":null,"Max":null,"RoundingBase":null,"NumberOfDecimals":0,"UnitId":null,"UnitCode":null,"VariableType":1,"DefaultValue":null,"ExtraFieldTemplateId":null,"Formula":"[707435042004352992]*[707434704849420055]*[707434704849420055]/[707434600696463128]*[707434668342198034]/1000000*100","BindPropertyType":null,"RowIndex":7,"SelectionComment":{"$id":"26","Id":"0","Text":"","RawText":"","HasFileLinks":false,"FileLinks":null},"SelectionType":0,"ValueSelectionType":2,"Value":{"$id":"27","Type":1,"StringValue":null,"BooleanValue":false,"NumericValue":0.16,"DateTimeValue":"0001-01-01T00:00:00"},"IsAvailable":true,"ValidationResults":[],"SelectionCommentDocumentOverrides":7,"DocumentDisplaySettings":null},{"$id":"28","Id":"707435042004352992","Name":"nHoles","Description":"Number of holes","Comment":null,"Mandatory":false,"HasDefaultValue":false,"Min":null,"Max":null,"RoundingBase":null,"NumberOfDecimals":0,"UnitId":"541165833092186662","UnitCode":"st.","VariableType":1,"DefaultValue":null,"ExtraFieldTemplateId":null,"Formula":"Floor((([707434600696463128]-50)+[707434796117475092])/([707434704849420055]+[707434796117475092]))\r\n*\r\nFloor((([707434668342198034]-50)+[707434796117475092])/([707434704849420055]+[707434796117475092]))","BindPropertyType":null,"RowIndex":8,"SelectionComment":{"$id":"29","Id":"0","Text":"","RawText":"","HasFileLinks":false,"FileLinks":null},"SelectionType":0,"ValueSelectionType":2,"Value":{"$id":"30","Type":1,"StringValue":null,"BooleanValue":false,"NumericValue":64,"DateTimeValue":"0001-01-01T00:00:00"},"IsAvailable":true,"ValidationResults":[],"SelectionCommentDocumentOverrides":7,"DocumentDisplaySettings":null}],"SelectionGroups":[{"$id":"31","Id":"993518285080342907","CanEditSelectedQuantity":false,"Code":"M240-1","Comment":null,"Description":"Hole shape","MaximumSelectedQuantity":null,"MaximumSelectedRows":1,"MinimumSelectedQuantity":null,"MinimumSelectedRows":1,"RowIndex":3,"Rows":[{"$id":"32","AlternativePreparationCode":null,"AutoCompleteConfigurationId":null,"Comment":null,"DefaultQuantity":1,"ExtraPercent":0,"HasSelections":false,"Id":"993518285080342908","CloneId":0,"Instruction":null,"IsDefaultSettings":false,"IsForCalculationOnly":false,"MainPartId":null,"MaxQuantity":1,"MinQuantity":1,"PartId":"707435321177219946","Position":null,"QuantityFormula":null,"RowIndex":0,"SetupQuantity":0,"SetupQuantityFormula":null,"ToOperation":10,"DiscountPercentage":0,"LockedDiscount":false,"LockedUnitPrice":false,"PriceFactor":64,"PriceFormulaText":"[707435042004352992]","Quantity":1,"SelectionComment":{"$id":"33","Id":"0","Text":"","RawText":"","HasFileLinks":false,"FileLinks":null},"SelectionType":30,"UnitPrice":{"$id":"34","Amount":0,"CurrencyId":"2"},"UnitPriceInCompanyCurrency":{"$id":"35","Amount":0,"CurrencyId":"2"},"IsSelected":true,"IsAvailable":true,"ValidationResults":[],"WeightPerUnit":null,"SelectionCommentDocumentOverrides":7},{"$id":"36","AlternativePreparationCode":null,"AutoCompleteConfigurationId":null,"Comment":null,"DefaultQuantity":1,"ExtraPercent":0,"HasSelections":false,"Id":"993518285080342909","CloneId":0,"Instruction":null,"IsDefaultSettings":false,"IsForCalculationOnly":false,"MainPartId":null,"MaxQuantity":1,"MinQuantity":1,"PartId":"707435482238493977","Position":null,"QuantityFormula":null,"RowIndex":1,"SetupQuantity":0,"SetupQuantityFormula":null,"ToOperation":10,"DiscountPercentage":0,"LockedDiscount":false,"LockedUnitPrice":false,"PriceFactor":64,"PriceFormulaText":"[707435042004352992]","Quantity":1,"SelectionComment":{"$id":"37","Id":"0","Text":"","RawText":"","HasFileLinks":false,"FileLinks":null},"SelectionType":10,"UnitPrice":{"$id":"38","Amount":0,"CurrencyId":"2"},"UnitPriceInCompanyCurrency":{"$id":"39","Amount":0,"CurrencyId":"2"},"IsSelected":false,"IsAvailable":true,"ValidationResults":[],"WeightPerUnit":null,"SelectionCommentDocumentOverrides":7}],"SelectionGroups":[],"SourceVersion":7,"IsAvailable":true,"ValidationResults":[]}],"RowIndex":0}]}""";

      AdapterLibrary.MonitorAPI adapter = new AdapterLibrary.MonitorAPI();

      string result = adapter.configurationToWeb(M240_PartConfigurationState, M240_All_Parts);

      // string partExpectedState1 = "{\"partId\":\"707433796463833993\",\"partNumber\":\"M-240\",\"variables\":{\"Width\":{\"id\":\"707434600696463128\",\"name\":\"Width\",\"value\":100}}}";
      var partExpectedState1 = new 
      {
        partId = "707433796463833993",
        partNumber = "M-240",
        variables = new Dictionary<string, double>(){
          ["Width"] = 100,
          ["Depth"] = 100,
          ["HoleSize"] = 5,
          ["HoleSpacing"] = 1,
          ["Area"] = 0.01,
          ["Perforation"] = 0.16,
          ["nHoles"] = 64,
        },
        selectionGroups = new Dictionary<string, string[]>(){
          ["M240-1"] = ["M-240-1"],
        }
      };
      var expectedResult = JsonSerializer.Serialize(partExpectedState1);
      Assert.AreEqual(result, expectedResult);
    }
}
